## Ultrasonic Distance SensorIn this chapter we will use an ultrasonic sensor to measure distances.### What do we need?In this lesson, we will use a setup with an ultrasonic sensor.#### Components- 1 Raspberry Pi connected to your network \(wired or wireless\)- 1 Breadboard- 1 HC-SR04 sensor- 1 Resistor \(1K ohms\)- 1 Resistor \(2K ohms\)- Jumper wires### Experimental theoryBefore constructing any circuit, you must know the parameters of the components in the circuit, such as their operating voltage, operating circuit, etc.#### The ultrasonic measureThe ultrasonic sensor that we will use in this tutorial has 4 PINs: GND Ground, VCC 5V, TRIG to send a pulse and ECHO to show how long time the pulse takes to go and back.#### How does HC-SR04 work?The sensor sends an ultrasonic pulse, triggered by a 10 μs 5V signal on the trigger pin \(TRIG\).It uses our Raspberry Pi to send a signal using the TRIG pin, which triggers the sensor to send an ultrasonic pulse.Pulse waves reflect against any nearby objects and some are reflected back to the sensor.The duration of the echo signal is proportional to the distance: we can approximate the distance using the speed of sound \(≈340m.s−1\).![HSRO4 ultrasonic sensor working principle.](figures/HSR04.pdf width=100&label=sonicSensorsWork)#### Limiting the return voltage with resistorsThe ECHO signal in sensor HC-SR04 uses 5V. But the Raspberry Pi PINS uses 3.3V. If we send 5V to the Raspberry Pi GPIO, it can damage the device.To avoid this, we will use 2 resistors to limit the voltage.### Experimental procedureNow we will build the circuit. This circuit consists of 1 ultrasonic sensor HC-SR04, 1 resistor 1K ohms, 1 resistor 2K ohms and a power supply \(the Rasp\).- Connect the Ground PIN from Raspberry on breadboard blue rail \(-\). In this experiment we will use the PIN9 \(Ground\);- Then connect the 5V \(PIN2\) pin in the red rail \(+\).- Now push the HC-SR04 sensor on breadboard;- And insert the jumper wires connecting the sensor leg TRIG in GPIO0 \(PIN11\) and the sensor leg ECHO in the breadboard, like the scheme shown in Figure *@physicalSonicSensors@*;- The last step is to connect the power 5V and ground \(-\) wires from the breadboard rails in sensor VCC + and GND \(-\) legs.Figure *@physicalSonicSensors@* shows how the electric connection is made.![Physical sensors connection.](figures/pharothings-ultrasonic-board.png width=60&label=physicalSonicSensors)### Connecting remotelyThrough your local Pharo image, let’s connect in the Pharo image by running on Raspberry, enable the auto-refresh feature of the inspector, and open the inspector.Run this code in your local playground:```remotePharo := TlpRemoteIDE connectTo: (TCPAddress ip: #[193 51 236 212] port: 40423)GTInspector enableStepRefresh.remoteBoard := remotePharo evaluate: [ RpiBoard3B current].remoteBoard inspect.```### Experimental codeIn your inspect window \(Inspector on a PotRemoteBoard\), let’s create an instance of the ultrasonic sensor.```d := board installDevice: PotHCSR04Device new.```As we saw before, we can inspect the remote object to see some properties and methods.Let's use the method `readDistance` to read the distance.This method returns a float representing the measured distance in centimetres.```d readDistance```